<?xml version="1.0" encoding="UTF-8"?>
<entities xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/entity-definition-3.xsd">

    <view-entity entity-name="TransferOrderShipmentReceiptHistory" package="co.hotwax.netsuite">
        <description>
            View to get the Transfer order Shipment Items not sent to NetSuite i.e. not part of OrderFulfillmentHistory.
            This view is used in the preparation of Transfer Order Shipment Receipt Feed for NetSuite.
        </description>
        <member-entity entity-alias="SR" entity-name="org.apache.ofbiz.shipment.receipt.ShipmentReceipt"/>
        <member-entity entity-alias="SH" entity-name="org.apache.ofbiz.shipment.shipment.Shipment" join-from-alias="SR">
            <key-map field-name="shipmentId"/>
        </member-entity>
        <member-entity entity-alias="SI" entity-name="org.apache.ofbiz.shipment.shipment.ShipmentItem" join-from-alias="SR">
            <key-map field-name="shipmentId"/>
            <key-map field-name="shipmentItemSeqId"/>
        </member-entity>
        <member-entity entity-alias="SRH" entity-name="co.hotwax.integration.shipment.ShipmentReceiptHistory" join-from-alias="SR" join-optional="true">
            <key-map field-name="receiptId"/>
        </member-entity>
        <alias entity-alias="SR" name="receiptId"/>
        <alias entity-alias="SR" name="orderId"/>
        <alias entity-alias="SR" name="orderItemSeqId"/>
        <alias entity-alias="SR" name="shipmentId"/>
        <alias entity-alias="SR" name="shipmentItemSeqId"/>
        <alias entity-alias="SR" name="totalQuantityAccepted" field="quantityAccepted" function="sum"/>
        <alias entity-alias="SR" name="quantityRejected"/>
        <alias entity-alias="SR" name="receivedDate" field="datetimeReceived" function="max"/>
        <alias entity-alias="SH" name="shipmentTypeId"/>
        <alias entity-alias="SH" name="statusId"/>
        <alias entity-alias="SH" field="externalId" name="shipmentExternalId"/>
        <alias entity-alias="SI" field="externalId" name="shipmentItemExternalId"/>
        <alias entity-alias="SI" name="productId"/>
        <entity-condition>
            <econdition entity-alias="SRH" field-name="historyId" value=""/>
            <econdition entity-alias="SH" field-name="shipmentTypeId" value="OUT_TRANSFER"/>
        </entity-condition>
    </view-entity>

    <view-entity entity-name="TransferOrderShipmentItemHistory" package="co.hotwax.netsuite">
        <description>
            View to get the Transfer order Shipment Items not sent to NetSuite i.e. not part of OrderFulfillmentHistory.
            This view is used in the preparation of Transfer Order Shipment Feed for NetSuite.
        </description>
        <member-entity entity-alias="SH" entity-name="org.apache.ofbiz.shipment.shipment.Shipment"/>
        <member-entity entity-alias="OSH" entity-name="org.apache.ofbiz.order.order.OrderShipment" join-from-alias="SH">
            <key-map field-name="shipmentId"/>
        </member-entity>
        <member-entity entity-alias="OFH" entity-name="co.hotwax.integration.order.OrderFulfillmentHistory" join-from-alias="OSH" join-optional="true">
            <key-map field-name="orderId"/>
            <key-map field-name="orderItemSeqId"/>
            <key-map field-name="shipmentId"/>
        </member-entity>
        <member-entity entity-alias="SRS" entity-name="org.apache.ofbiz.shipment.shipment.ShipmentRouteSegment" join-from-alias="SH">
            <key-map field-name="shipmentId"/>
        </member-entity>
        <member-entity entity-alias="F" entity-name="org.apache.ofbiz.product.facility.Facility" join-from-alias="SH">
            <key-map field-name="originFacilityId" related="facilityId"/>
        </member-entity>
        <member-entity entity-alias="FT" entity-name="org.apache.ofbiz.product.facility.FacilityType" join-from-alias="F">
            <key-map field-name="facilityTypeId"/>
        </member-entity>
        <alias-all entity-alias="OSH"/>
        <alias entity-alias="SH" name="shipmentTypeId"/>
        <alias entity-alias="SH" name="statusId"/>
        <alias entity-alias="SRS" name="trackingIdNumber"/>
        <alias entity-alias="F" name="facilityId"/>
        <alias entity-alias="F" field="externalId" name="facilityExternalId"/>
        <alias entity-alias="FT" name="facilityTypeId"/>
        <alias entity-alias="FT" field="parentTypeId" name="parentFacilityTypeId"/>
        <entity-condition>
            <econdition entity-alias="OFH" field-name="orderId" value=""/>
            <econdition entity-alias="SH" field-name="shipmentTypeId" value="OUT_TRANSFER"/>
        </entity-condition>
    </view-entity>
    <view-entity entity-name="TransferOrderWithIdentification" package="co.hotwax.netsuite">
        <member-entity entity-alias="OH" entity-name="org.apache.ofbiz.order.order.OrderHeader"/>
        <member-entity entity-alias="OID" entity-name="co.hotwax.order.OrderIdentification" join-from-alias="OH">
            <key-map field-name="orderId"/>
            <entity-condition>
                <econdition field-name="orderIdentificationTypeId" value="NETSUITE_ORDER_ID"/>
            </entity-condition>
        </member-entity>
        <alias-all entity-alias="OID"/>
        <alias field="orderId" name="hotwaxOrderId" entity-alias="OH"/>
        <alias name="entryDate" entity-alias="OH"/>
        <entity-condition>
            <econdition field-name="orderTypeId" entity-alias="OH" value="TRANSFER_ORDER"/>
        </entity-condition>
    </view-entity>

    <view-entity entity-name="TransferOrderItemSyncView" package="co.hotwax.netsuite.order">
        <description>View to get Transfer Order details.</description>
        <member-entity entity-alias="OH" entity-name="org.apache.ofbiz.order.order.OrderHeader"/>
        <member-entity entity-alias="PS" entity-name="org.apache.ofbiz.product.store.ProductStore" join-from-alias="OH">
            <key-map field-name="productStoreId" related="productStoreId"/>
        </member-entity>
        <member-entity entity-alias="SCENM" entity-name="moqui.basic.Enumeration" join-from-alias="OH" join-optional="true">
            <key-map field-name="salesChannelEnumId" related="enumId"/>
        </member-entity>
        <member-entity entity-alias="OI" entity-name="org.apache.ofbiz.order.order.OrderItem" join-from-alias="OH">
            <key-map field-name="orderId"/>
        </member-entity>
        <member-entity entity-alias="OISG" entity-name="org.apache.ofbiz.order.order.OrderItemShipGroup" join-from-alias="OI">
            <key-map field-name="orderId"/>
            <key-map field-name="shipGroupSeqId"/>
        </member-entity>
        <member-entity entity-alias="OID" entity-name="co.hotwax.order.OrderIdentification" join-from-alias="OH" join-optional="true">
            <key-map field-name="orderId"/>
            <entity-condition>
                <econdition entity-alias="OID" field-name="orderIdentificationTypeId" value="NETSUITE_ORDER_ID"/>
                <date-filter/>
            </entity-condition>
        </member-entity>
        <member-entity entity-alias="INVORD" entity-name="co.hotwax.netsuite.order.InvalidNetSuiteTOOrders" sub-select="non-lateral" join-from-alias="OH" join-optional="true">
            <key-map field-name="orderId"/>
        </member-entity>

        <alias-all entity-alias="OISG">
            <exclude field="orderId"/>
            <exclude field="shipGroupSeqId"/>
        </alias-all>
        <alias entity-alias="OI" name="orderItemSeqId"/>
        <alias entity-alias="OI" field="externalId" name="orderItemExternalId"/>
        <alias entity-alias="OI" name="statusId"/>
        <alias entity-alias="OI" name="productId"/>
        <alias entity-alias="OI" name="quantity"/>
        <alias entity-alias="OI" name="cancelQuantity"/>
        <alias entity-alias="OI" name="unitPrice"/>
        <alias entity-alias="OI" name="shipGroupSeqId"/>

        <alias entity-alias="OH" name="orderId"/>
        <alias entity-alias="OH" name="orderDate"/>
        <alias entity-alias="OH" name="originFacilityId"/>
        <alias entity-alias="OH" name="externalId"/>
        <alias entity-alias="OH" name="orderName"/>
        <alias entity-alias="PS" field="externalId" name="productStoreExternalId"/>
        <alias entity-alias="SCENM" field="description" name="salesChannel"/>

        <entity-condition>
            <econdition field-name="orderTypeId" entity-alias="OH" operator="equals" value="TRANSFER_ORDER"/>
            <econdition entity-alias="OID" field-name="orderId" operator="equals" value=""/>
            <econdition entity-alias="INVORD" field-name="orderId" operator="equals" value=""/>
        </entity-condition>
    </view-entity>

    <view-entity entity-name="InvalidNetSuiteTOOrders" package="co.hotwax.netsuite.order">
        <member-entity entity-alias="OH" entity-name="org.apache.ofbiz.order.order.OrderHeader"/>
        <member-entity entity-alias="OI" entity-name="org.apache.ofbiz.order.order.OrderItem" join-from-alias="OH">
            <key-map field-name="orderId"/>
        </member-entity>
        <member-entity entity-alias="GID" entity-name="org.apache.ofbiz.product.product.GoodIdentification" join-from-alias="OI" join-optional="true">
            <key-map field-name="productId"/>
            <entity-condition>
                <econdition field-name="goodIdentificationTypeId" value="NETSUITE_PRODUCT_ID"/>
                <date-filter/>
            </entity-condition>
        </member-entity>
        <alias-all entity-alias="OH"/>
        <alias name="productId" entity-alias="OI" field="productId"/>
        <entity-condition>
            <econdition field-name="goodIdentificationTypeId" entity-alias="GID" operator="is-null"/>
            <econdition field-name="orderTypeId" entity-alias="OH" operator="equals" value="TRANSFER_ORDER"/>
        </entity-condition>
    </view-entity>
</entities>
